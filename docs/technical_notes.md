# æŠ€æœ¯æ–‡æ¡£

## ğŸ”¬ ç®—æ³•åŸç†

### ç”µç£åœºæ§åˆ¶æ–¹ç¨‹

æ±‚è§£å™¨åŸºäºé¢‘åŸŸMaxwellæ–¹ç¨‹çš„æ ‡é‡ç”µä½å½¢å¼ï¼š

```
âˆ‡ Â· (Îµâˆ‡Ï†) + jÏ‰ÏƒÏ† = Ï
```

å…¶ä¸­ï¼š
- Ï†: æ ‡é‡ç”µä½ï¼ˆå¤æ•°ï¼‰
- Îµ: ä»‹ç”µå¸¸æ•°
- Ïƒ: ç”µå¯¼ç‡
- Ï‰: è§’é¢‘ç‡ (2Ï€ Ã— 50Hz)
- Ï: ç”µè·å¯†åº¦

### æœ‰é™å…ƒç¦»æ•£åŒ–

#### 1. å®éƒ¨-è™šéƒ¨åˆ†ç¦»

å°†å¤æ•°ç”µä½åˆ†è§£ä¸ºå®éƒ¨å’Œè™šéƒ¨ï¼š
Ï† = Ï†_real + jÂ·Ï†_imag

å¾—åˆ°è€¦åˆçš„å®æ•°æ–¹ç¨‹ç»„ï¼š
```
âˆ‡ Â· (Îµâˆ‡Ï†_real) - Ï‰ÏƒÏ†_imag = Ï_real
âˆ‡ Â· (Îµâˆ‡Ï†_imag) + Ï‰ÏƒÏ†_real = Ï_imag
```

#### 2. å¼±å½¢å¼

å¯¹äºå®éƒ¨ï¼š
```
âˆ«_Î© Îµâˆ‡Ï†_realÂ·âˆ‡v dÎ© - Ï‰âˆ«_Î© ÏƒÏ†_imagÂ·v dÎ© = âˆ«_Î© Ï_realÂ·v dÎ©
```

å¯¹äºè™šéƒ¨ï¼š
```
âˆ«_Î© Îµâˆ‡Ï†_imagÂ·âˆ‡v dÎ© + Ï‰âˆ«_Î© ÏƒÏ†_realÂ·v dÎ© = âˆ«_Î© Ï_imagÂ·v dÎ©
```

#### 3. äºŒé˜¶è¿ç»­Galerkinå…ƒç´ 

ä½¿ç”¨CG2ï¼ˆäºŒé˜¶è¿ç»­Galerkinï¼‰æœ‰é™å…ƒï¼š
- æä¾›äºŒé˜¶ç²¾åº¦
- é€‚åˆç”µç£åœºçš„å…‰æ»‘æ€§è¦æ±‚
- åœ¨å¯¼ä½“è¾¹ç•Œå¤„ä¿æŒè¿ç»­æ€§

## ğŸ”§ æ•°å€¼ç¨³å®šæ€§æŠ€æœ¯

### 1. ä¸¤é˜¶æ®µæ±‚è§£ç­–ç•¥

#### ç¬¬ä¸€é˜¶æ®µï¼šç®€åŒ–é¢„çƒ­
```
simplified_sigma = original_sigma * 0.1
# æ±‚è§£ç®€åŒ–é—®é¢˜è·å¾—åˆå€¼
```

#### ç¬¬äºŒé˜¶æ®µï¼šå®Œæ•´æ±‚è§£
```
# ä½¿ç”¨ç¬¬ä¸€é˜¶æ®µç»“æœä½œä¸ºåˆå€¼
# æ±‚è§£å®Œæ•´çš„é«˜å¯¹æ¯”åº¦é—®é¢˜
```

**ä¼˜åŠ¿**ï¼š
- æé«˜é«˜å¯¹æ¯”åº¦ææ–™çš„æ”¶æ•›æ€§
- å‡å°‘è¿­ä»£æ¬¡æ•°
- é¿å…åˆå€¼æ•æ„Ÿæ€§é—®é¢˜

### 2. ææ–™å±æ€§ç¼©æ”¾

```
# ä»‹ç”µå¸¸æ•°æ”¾å¤§
scaled_epsilon = epsilon * 1e8

# ç”µå¯¼ç‡ç¼©å°
scaled_sigma = sigma * 1e-5

# é¢‘ç‡ç¼©å°
scaled_omega = omega * 1e-2
```

**ç›®çš„**ï¼š
- æ”¹å–„ç³»æ•°çŸ©é˜µæ¡ä»¶æ•°
- é¿å…æç«¯æ•°å€¼èŒƒå›´
- æé«˜ç›´æ¥æ±‚è§£å™¨æ€§èƒ½

### 3. å¹³æ»‘è¾¹ç•Œè¿‡æ¸¡

```
def smooth_transition(x, center, width):
    return 0.5 + 0.5 * tanh((width - abs(x - center))/width*8)
```

**åº”ç”¨**ï¼š
- æ¶ˆé™¤å¯¼ä½“-ç»ç¼˜ä½“ç•Œé¢çš„æ•°å€¼éœ‡è¡
- æä¾›CÂ¹è¿ç»­çš„ææ–™åˆ†å¸ƒ
- é¿å…äººå·¥ä¸è¿ç»­æ€§

## ğŸ¯ è¾¹ç•Œæ¡ä»¶å¤„ç†

### 1. Dirichletè¾¹ç•Œæ¡ä»¶

åœ¨å¯¼ä½“è¡¨é¢æ–½åŠ å›ºå®šç”µä½ï¼š
```
Ï†|_Î“_conductor = V_specified
```

**å®ç°**ï¼š
```
# Aç›¸å¯¼ä½“: 120kV âˆ 0Â°
V_PhaseA = 120e3 * exp(j * 0Â°)
bc_real = DirichletBC(V_real, V_PhaseA.real, boundary_id)
bc_imag = DirichletBC(V_imag, V_PhaseA.imag, boundary_id)
```

### 2. Robinè¾¹ç•Œæ¡ä»¶

åœ¨è¿œåœºè¾¹ç•Œä½¿ç”¨Robinæ¡ä»¶ï¼š
```
Î±Â·Ï† + Î²Â·(âˆ‡Ï†Â·n) = 0
```

**ç‰©ç†æ„ä¹‰**ï¼š
- æ¨¡æ‹Ÿæ— é™è¿œå¤„çš„è¡°å‡
- é¿å…äººå·¥åå°„
- é€‚åˆå¼€æ”¾åŸŸé—®é¢˜

**å‚æ•°é€‰æ‹©**ï¼š
- Î± = 1.0ï¼šç”µä½è¡°å‡æƒé‡
- Î² = 0.5ï¼šæ¢¯åº¦è¡°å‡æƒé‡ï¼ˆå¯è°ƒï¼‰

## ğŸ“Š ç©ºé—´ææ–™è¯†åˆ«

### åŸºäºåæ ‡çš„åŒºåŸŸåˆ’åˆ†

```
# å¡”æ¶åŒºåŸŸè¯†åˆ«
tower_region = conditional(
    smooth_transition(abs(x - tower_x_center), tower_width/2, transition_width) *
    smooth_transition(abs(x - tower_y_center), tower_width/2, transition_width) > 0.5,
    1.0, 0.0
)

# å¯¼çº¿åŒºåŸŸè¯†åˆ«  
wire_region = conditional(
    smooth_transition(sqrt((x - wire_x)**2 + (x - wire_y)**2), 
                      wire_radius, transition_width) > 0.5,
    1.0, 0.0
)
```

**ä¼˜åŠ¿**ï¼š
- æ— éœ€å¤æ‚çš„CADå‡ ä½•å¯¼å…¥
- æ”¯æŒç‚¹äº‘æ•°æ®ç›´æ¥å¤„ç†
- å¯è°ƒçš„è¿‡æ¸¡åŒºå®½åº¦

### ææ–™å±æ€§åˆ†é…

| ææ–™ | ç”µå¯¼ç‡ (S/m) | ç›¸å¯¹ä»‹ç”µå¸¸æ•° |
|------|-------------|-------------|
| é“å¯¼çº¿ | 35,000 | 1.0 |
| é’¢å¡”æ¶ | 5,800 | 1.0 |
| é™¶ç“·ç»ç¼˜å­ | 1Ã—10â»Â¹Â² | 7.5 |
| ç©ºæ°” | 0 | 1.0006 |

## âš™ï¸ æ±‚è§£å™¨é…ç½®

### ç›´æ¥æ±‚è§£å™¨ï¼ˆæ¨èï¼‰

```
solver_parameters = {
    'ksp_type': 'preonly',
    'pc_type': 'lu',
    'pc_factor_mat_solver_type': 'mumps',
    'mat_mumps_icntl_24': 1,      # æé«˜ç¨³å®šæ€§
    'mat_mumps_icntl_14': 300,    # å¢åŠ å·¥ä½œå†…å­˜
    'ksp_rtol': 1e-6
}
```

**é€‚ç”¨åœºæ™¯**ï¼š
- é«˜å¯¹æ¯”åº¦ææ–™é—®é¢˜
- ä¸­ç­‰è§„æ¨¡ç½‘æ ¼ï¼ˆ= x_min) & 
            (coordinates[:, 0] = y_min) & 
            (coordinates[:, 1] <= y_max))
```

#### ç©ºæ°”åŒºåŸŸè¿‡æ»¤
```
air_mask = (sigma < 1e-8)  # è¯†åˆ«ä½ç”µå¯¼ç‡åŒºåŸŸ
```

## ğŸ” éªŒè¯æ–¹æ³•

### 1. ç‰©ç†ä¸€è‡´æ€§æ£€æŸ¥

- **å¯¼ä½“å†…éƒ¨ä½åœºå¼º**ï¼šå¯¼ä½“å†…éƒ¨ç”µåœºåº”æ¥è¿‘é›¶
- **è¾¹ç•Œè¿ç»­æ€§**ï¼šç”µä½åœ¨ç•Œé¢è¿ç»­
- **è¿œåœºè¡°å‡**ï¼šç”µåœºåœ¨è¿œå¤„æŒ‰1/rÂ²è¡°å‡

### 2. æ•°å€¼æ”¶æ•›æ€§

- **ç½‘æ ¼æ”¶æ•›**ï¼šç»†åŒ–ç½‘æ ¼éªŒè¯è§£çš„æ”¶æ•›æ€§
- **è¿­ä»£æ”¶æ•›**ï¼šç›‘æ§æ±‚è§£å™¨æ®‹å·®ä¸‹é™
- **èƒ½é‡å®ˆæ’**ï¼šæ£€æŸ¥åŠŸç‡å¹³è¡¡

### 3. å¯¹æ¯”éªŒè¯

- **è§£æè§£å¯¹æ¯”**ï¼šç®€å•å‡ ä½•çš„è§£æè§£éªŒè¯
- **å•†ä¸šè½¯ä»¶å¯¹æ¯”**ï¼šå¤æ‚å‡ ä½•çš„åŸºå‡†å¯¹æ¯”
- **å®éªŒæ•°æ®å¯¹æ¯”**ï¼šæµ‹é‡æ•°æ®çš„å®šé‡éªŒè¯

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### å†…å­˜ç®¡ç†

```
# ä½¿ç”¨åˆé€‚çš„å‡½æ•°ç©ºé—´é˜¶æ•°
V_real = FunctionSpace(mesh, "CG", 2)  # äºŒé˜¶ç²¾åº¦

# åˆ†å—å¤„ç†å¤§å‹æ•°æ®
for block in data_blocks:
    process_block(block)
```

### å¹¶è¡Œè®¡ç®—

```
# Firedrakeè‡ªåŠ¨å¹¶è¡Œ
# ä½¿ç”¨MPIè¿è¡Œï¼š
# mpirun -n 4 python tower_em_solver.py
```

### æ•°æ®å‹ç¼©

```
# NPZæ ¼å¼è‡ªåŠ¨å‹ç¼©
np.savez_compressed(filename, **data)
```

## ğŸ”¬ æ‰©å±•æ–¹å‘

### 1. éçº¿æ€§ææ–™

- ç£æ»å›çº¿å»ºæ¨¡
- é¥±å’Œæ•ˆåº”å¤„ç†
- æ¸©åº¦ä¾èµ–æ€§

### 2. æ—¶åŸŸåˆ†æ

- ç¬æ€å“åº”åˆ†æ
- é›·ç”µå†²å‡»æ¨¡æ‹Ÿ
- å¼€å…³æš‚æ€è®¡ç®—

### 3. å¤šç‰©ç†åœºè€¦åˆ

- ç”µ-çƒ­è€¦åˆ
- ç”µ-åŠ›è€¦åˆ
- æµä½“-ç”µç£è€¦åˆ

### 4. è‡ªé€‚åº”ç½‘æ ¼

- åŸºäºè¯¯å·®æŒ‡ç¤ºå™¨çš„ç½‘æ ¼ç»†åŒ–
- å„å‘å¼‚æ€§ç½‘æ ¼é€‚åº”
- åŠ¨æ€è´Ÿè½½å¹³è¡¡

---

## ğŸ“š å‚è€ƒæ–‡çŒ®

1. **æœ‰é™å…ƒæ–¹æ³•**ï¼š
   - Zienkiewicz, O.C. & Taylor, R.L. "The Finite Element Method"

2. **è®¡ç®—ç”µç£å­¦**ï¼š
   - Jin, J. "The Finite Element Method in Electromagnetics"

3. **Firedrakeæ–‡æ¡£**ï¼š
   - https://firedrakeproject.org/

4. **ç”µåŠ›ç³»ç»Ÿç”µç£åˆ†æ**ï¼š
   - IEEE Standards for electromagnetic field computation
```